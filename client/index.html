<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="./styles.css" />
		<title>Easy URL Shortner</title>
	</head>
	<body>
		<div class="container">
			<form action="http://localhost:3000/" method="POST">
				<input
					type="text"
					name="url"
					id="url"
					placeholder="Shorten a link here..."
				/>
				<button class="type" onclick="shortenUrl(event)">
					Shorten it!
				</button>
			</form>
		</div>
		<script>
			function shortenUrl(event) {
				event.preventDefault();
				const url = document.getElementById("url").value;
				fetch("http://localhost:3000/", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify({ url }),
				})
					.then((res) => res.json())
					.then((data) => {
						createShortUrlElement(url, data["short-url"]);
					})
					.catch((err) => console.log(err));
			}

			function createShortUrlElement(longUrlStr, shortUrlStr) {
				const container = document.createElement("div");
				container.className = "list";

				const listElement = document.createElement("div");
				listElement.className = "list-element";

				const heading = document.createElement("h3");
				heading.textContent = longUrlStr;
				listElement.appendChild(heading);

				const shortUrlContainer = document.createElement("div");
				shortUrlContainer.className = "short-url";

				const shortUrlSpan = document.createElement("span");
				shortUrlSpan.textContent = shortUrlStr;
				shortUrlContainer.appendChild(shortUrlSpan);

				const copyButton = document.createElement("button");
				copyButton.className = "copy-button";
				copyButton.textContent = "Copy";
				shortUrlContainer.appendChild(copyButton);

				listElement.appendChild(shortUrlContainer);
				container.appendChild(listElement);
				document.body.appendChild(container);
			}
			createShortUrlElement(
				"https://www.google.com/",
				"http://smallurl/abc123",
			);
		</script>
	</body>
</html>
